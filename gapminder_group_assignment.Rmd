---
title: "Gapminder Group Project"
author: "David Dvorak, Elton Chan, Fanli Si, Jingyang Liu"
date: "November 16, 2016"
output: 
  html_document: 
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Our Hypothesis:
Countries with higher per-capita GDP have higher life expectancies.

# Our Analysis:

```{r load_packages, message=FALSE, results='hide',include=FALSE}
library(ggplot2)
library(plyr)
library(dplyr)
library(gapminder)
#install.packages("gapminder")
```

A couple potential plots:
```{r}
df <- gapminder %>%
  mutate(gdpPercap_change = 100*((gdpPercap - lag(gdpPercap)))/gdpPercap) %>%
  mutate(lifeExp_change = 100*((lifeExp - lag(lifeExp)))/lifeExp) %>%
  filter(year > 1952)

qplot(log(gdpPercap),lifeExp,data=df, color = continent)
qplot(log(gdpPercap),lifeExp,data=df, color = year)
```


A follow-up question on the relationship between GDP and life expectancy is whether or not the rate of change of a country's life expectancy is impacted by the rate of change of its per-capita GDP. 

```{r}
ggplot(df, aes(x=gdpPercap_change,y=lifeExp_change, color = continent)) + geom_point() + geom_smooth(method=lm, se = FALSE) + ylim(-25,25) + xlim(-50,50) + labs(title="Comparing Growth Rates of Life Expectancy and Per-Capita GDP") +
  labs(x="Per-Capita GDP Growth Rate (%)", y="Life Expectancy Growth Rate (%)")
```

The scatterplot includes linear regression lines for each continent and the fitting results are as follows:

```{r}
fit_africa <- lm(lifeExp_change ~ gdpPercap_change, data = (df %>% filter(continent == 'Africa')))
summary(fit_africa)
fit_americas <- lm(lifeExp_change ~ gdpPercap_change, data = (df %>% filter(continent == 'Americas')))
summary(fit_americas)
fit_asia <- lm(lifeExp_change ~ gdpPercap_change, data = (df %>% filter(continent == 'Asia')))
summary(fit_asia)
fit_europe <- lm(lifeExp_change ~ gdpPercap_change, data = (df %>% filter(continent == 'Europe')))
summary(fit_europe)
fit_oceania <- lm(lifeExp_change ~ gdpPercap_change, data = (df %>% filter(continent == 'Oceania')))
summary(fit_oceania)

```